#!/bin/bash
name="theHarvester"
dst="$HOME/.local/src/$name"

git clone "https://github.com/laramies/$name" "$dst"
cd "$dst" || exit 1
chown -R "$USER:$USER" "$dst"

while read line;do
    [[ "$line" ]] || continue
    line="$(cut -d"=" -f1 <<< "$line")"

    pip show "$line" &>"/dev/null" && continue
    pip install "$line" || exit 1
    [[ "$NO_BACKUP" ]] || echo "pip:$line" >> "$BACKUP/diff"

done<"requirements/base.txt"
chown -r "$USER:$USER" "$HOME/.local/share/pyenv"

cat<<EOF >"$HOME/.local/bin/$name"
#!/bin/bash
cd "$dst" || exit 1
./$name.py "\$@"
EOF
chmod +x "$HOME/.local/bin/$name"
chown "$USER:$USER" "$HOME/.local/bin/$name"
